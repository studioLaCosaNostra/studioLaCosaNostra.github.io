(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{rZCR:function(e,t,n){"use strict";n.r(t);var i=n("8Y7J");class s{}var o=n("pMnS"),a=n("fGXz"),l=n("AytR");class r{constructor(e,t,n){this.elementRef=e,this.ngZone=t,this.platform=n,this.devicePixelRatio=l.a.ssr?1:window.devicePixelRatio||1,this.applicationOptions={}}init(){l.a.ssr||(this.ngZone.runOutsideAngular(()=>{this.app=new a.Application(this.applicationOptions)}),this.elementRef.nativeElement.appendChild(this.app.view),this.resize())}ngOnInit(){this.init()}resize(){const e=1/this.devicePixelRatio;this.app.renderer.resize(this.elementRef.nativeElement.offsetWidth*this.devicePixelRatio,this.elementRef.nativeElement.offsetHeight*this.devicePixelRatio),this.app.view.style.transform=`scale(${e})`,this.app.view.style.transformOrigin="top left"}destroy(){this.app&&this.app.destroy()}ngOnDestroy(){this.destroy()}}var c=n("/HVE"),u=i.ob({encapsulation:2,styles:[],data:{}});function h(e){return i.Hb(0,[],null,null)}var p=n("HDdC"),d=n("D0XW"),m=n("DH7j");function b(e=0,t=d.a){var n;return n=e,(Object(m.a)(n)||!(n-parseFloat(n)+1>=0)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=d.a),new p.a(n=>(n.add(t.schedule(g,e,{subscriber:n,counter:0,period:e})),n))}function g(e){const{subscriber:t,counter:n,period:i}=e;t.next(n),this.schedule({subscriber:t,counter:n+1,period:i},i)}class v{constructor(){this.shot=new i.m,this.move=new i.m,this.pressedMoveKeys=new Set,this.pressedShot=!1}ngOnInit(){l.a.ssr||(this.intervalSubscription=b(50).subscribe(()=>{const e=function(e){const t=Array.from(e);return t[t.length-1]}(this.pressedMoveKeys);this.move.emit(e),this.pressedShot&&this.shot.emit()}))}ngOnDestroy(){l.a.ssr||this.intervalSubscription.unsubscribe()}pressShot(e){return e.preventDefault(),e.stopPropagation(),this.pressedShot=!0,!1}releaseShot(e){return e.preventDefault(),e.stopPropagation(),this.pressedShot=!1,!1}release(e){this.pressedMoveKeys.delete(e)}press(e){this.pressedMoveKeys.add(e)}touchmove(e){e.preventDefault(),e.stopPropagation();const t=e.touches.item(0);if(!t)return!1;const n=document.elementFromPoint(t.clientX,t.clientY);return!!n&&(this.moveControllers.nativeElement.contains(n)&&n.classList.contains("button")&&(this.pressedMoveKeys.clear(),this.press(n.classList.toString().replace("button","").trim())),!1)}touchend(e){return e.preventDefault(),e.stopPropagation(),this.pressedMoveKeys.clear(),!1}handleKeyDownEvent(e){switch(e.key){case"ArrowLeft":this.press("left");break;case"ArrowRight":this.press("right");break;case"ArrowUp":this.press("up");break;case"ArrowDown":this.press("down");break;case" ":this.pressedShot=!0}}handleKeyUpEvent(e){switch(e.key){case"ArrowLeft":this.release("left");break;case"ArrowRight":this.release("right");break;case"ArrowUp":this.release("up");break;case"ArrowDown":this.release("down");break;case" ":this.pressedShot=!1}}}var w=i.ob({encapsulation:0,styles:[[".tank-move-controllers[_ngcontent-%COMP%]{z-index:1;position:absolute;bottom:10px;left:10px}.tank-move-controllers[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-image:url(/games/tanks/arrow-controller.1d1c9cc0c5ca19e42365.png);width:64px;height:64px;position:relative;opacity:.7}.tank-move-controllers[_ngcontent-%COMP%]   .up[_ngcontent-%COMP%]{left:64px;top:64px}.tank-move-controllers[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{top:64px;left:128px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.tank-move-controllers[_ngcontent-%COMP%]   .down[_ngcontent-%COMP%]{top:64px;left:64px;-webkit-transform:rotate(180deg);transform:rotate(180deg)}.tank-move-controllers[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{top:-64px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.tank-shot-controller[_ngcontent-%COMP%]{z-index:1;position:absolute;bottom:62px;right:55px}.tank-shot-controller[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-image:url(/games/tanks/shot-controller.c287a59665cc4e5ef601.png);width:85px;height:85px;position:relative;opacity:.7}"]],data:{}});function f(e){return i.Hb(0,[i.Eb(402653184,1,{moveControllers:0}),(e()(),i.qb(1,0,[[1,0],["moveControllers",1]],null,4,"div",[["class","tank-move-controllers"]],null,null,null,null,null)),(e()(),i.qb(2,0,null,null,0,"div",[["class","up button"]],null,[[null,"touchstart"],[null,"touchmove"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"],[null,"mouseleave"]],(function(e,t,n){var i=!0,s=e.component;return"touchstart"===t&&(i=!1!==s.touchmove(n)&&i),"touchmove"===t&&(i=!1!==s.touchmove(n)&&i),"touchend"===t&&(i=!1!==s.touchend(n)&&i),"mousedown"===t&&(i=!1!==s.press("up")&&i),"mouseup"===t&&(i=!1!==s.release("up")&&i),"mouseleave"===t&&(i=!1!==s.release("up")&&i),i}),null,null)),(e()(),i.qb(3,0,null,null,0,"div",[["class","right button"]],null,[[null,"touchstart"],[null,"touchmove"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"],[null,"mouseleave"]],(function(e,t,n){var i=!0,s=e.component;return"touchstart"===t&&(i=!1!==s.touchmove(n)&&i),"touchmove"===t&&(i=!1!==s.touchmove(n)&&i),"touchend"===t&&(i=!1!==s.touchend(n)&&i),"mousedown"===t&&(i=!1!==s.press("right")&&i),"mouseup"===t&&(i=!1!==s.release("right")&&i),"mouseleave"===t&&(i=!1!==s.release("right")&&i),i}),null,null)),(e()(),i.qb(4,0,null,null,0,"div",[["class","down button"]],null,[[null,"touchstart"],[null,"touchmove"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"],[null,"mouseleave"]],(function(e,t,n){var i=!0,s=e.component;return"touchstart"===t&&(i=!1!==s.touchmove(n)&&i),"touchmove"===t&&(i=!1!==s.touchmove(n)&&i),"touchend"===t&&(i=!1!==s.touchend(n)&&i),"mousedown"===t&&(i=!1!==s.press("down")&&i),"mouseup"===t&&(i=!1!==s.release("down")&&i),"mouseleave"===t&&(i=!1!==s.release("down")&&i),i}),null,null)),(e()(),i.qb(5,0,null,null,0,"div",[["class","left button"]],null,[[null,"touchstart"],[null,"touchmove"],[null,"touchend"],[null,"mousedown"],[null,"mouseup"],[null,"mouseleave"]],(function(e,t,n){var i=!0,s=e.component;return"touchstart"===t&&(i=!1!==s.touchmove(n)&&i),"touchmove"===t&&(i=!1!==s.touchmove(n)&&i),"touchend"===t&&(i=!1!==s.touchend(n)&&i),"mousedown"===t&&(i=!1!==s.press("left")&&i),"mouseup"===t&&(i=!1!==s.release("left")&&i),"mouseleave"===t&&(i=!1!==s.release("left")&&i),i}),null,null)),(e()(),i.qb(6,0,null,null,1,"div",[["class","tank-shot-controller"]],null,null,null,null,null)),(e()(),i.qb(7,0,null,null,0,"div",[["class","shot button"]],null,[[null,"touchstart"],[null,"touchend"]],(function(e,t,n){var i=!0,s=e.component;return"touchstart"===t&&(i=!1!==s.pressShot(n)&&i),"touchend"===t&&(i=!1!==s.releaseShot(n)&&i),i}),null,null))],null,null)}var k=n("iInd"),x=n("mrSG"),y=n("ePZZ"),O=n("XNiG"),_=n("xgIS"),P=n("Cfvw"),C=n("1G5W"),S=n("Kj3r"),M=n("pLZG"),j=n("vkgz"),A=n("7o/Q");n("l7GE"),n("ZUHj");const z={leading:!0,trailing:!1};class R{constructor(e,t,n,i){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=i}call(e,t){return t.subscribe(new L(e,this.duration,this.scheduler,this.leading,this.trailing))}}class L extends A.a{constructor(e,t,n,i,s){super(e),this.duration=t,this.scheduler=n,this.leading=i,this.trailing=s,this._hasTrailingValue=!1,this._trailingValue=null}_next(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(q,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))}_complete(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}clearThrottle(){const e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)}}function q(e){const{subscriber:t}=e;t.clearThrottle()}var V=n("qdB0"),E=n("9Chx"),D=n("Lvkc"),G=n("wRQt");const K=(e,t)=>{const n=e.findIndex(e=>e===t);return-1===n||n+1>e.length-1?e[0]:e[n+1]};var T=n("+cCG");const H=()=>{let e=!1;return(t=>{(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)})(navigator.userAgent||navigator.vendor),e};class X{constructor(e,t,n,i,s,o,a){this.gameService=e,this.ngZone=t,this.elRef=n,this.route=i,this.router=s,this.adsService=o,this.analytics=a,this.hideControllers=!0,this.canWatchAds=!0,this.moveEvent=new O.a,this.destroySubject=new O.a,this.devicePixelRatio=l.a.ssr?1:window.devicePixelRatio||1,this.fullscreen=!1,this.analytics.setCurrentScreen("game")}loadLevels(){return this.gameService.getLevels().toPromise()}ngAfterViewInit(){return x.__awaiter(this,void 0,void 0,(function*(){if(l.a.ssr)return;this.initContainer();const e=yield this.loadLevels();yield Object(G.a)(),T.a.dispatch({type:y.a.SetupPIXI,container:this.container}),T.a.dispatch({type:y.a.SetupLevelLoader,nextLevel:t=>this.loadLevel(K(e,t))}),T.a.dispatch({type:y.a.SetupRewardedAd,showRewardedAd:()=>this.adsService.rewardVideo()}),this.setupAXY(),this.route.data.pipe(Object(C.a)(this.destroySubject)).subscribe(e=>x.__awaiter(this,void 0,void 0,(function*(){e.fullscreen&&(this.fullscreen=!0,function(e){return x.__awaiter(this,void 0,void 0,(function*(){yield e.requestFullscreen(),yield window.screen.orientation.lock("landscape")}))}(this.elRef.nativeElement).then(()=>this.onResize()).catch(e=>{console.warn(e)})),e.resume&&T.a.getState().currentGame.status!==E.a.None?Object(D.a)(T.a.getState())&&T.a.dispatch(Object(V.c)()):T.a.dispatch({type:y.a.NewGame}),Object(_.a)(window,"fullscreenchange").pipe(Object(C.a)(this.destroySubject)).subscribe(()=>{this.setupAXY()}),b(1e3).pipe(Object(S.a)(500),Object(M.a)(()=>H()),Object(j.a)(()=>{matchMedia("(orientation: landscape)").matches||this.router.navigate([".."])}),Object(C.a)(this.destroySubject)).subscribe(),b(1e3).pipe(Object(C.a)(this.destroySubject)).subscribe(()=>{T.a.getState().currentGame.status===E.a.Start&&document.hidden&&this.router.navigate([".."]),this.setupAXY()})}))),this.storeSubscribe=this.ngZone.runOutsideAngular(()=>T.a.subscribe(()=>x.__awaiter(this,void 0,void 0,(function*(){const e=T.a.getState();this.hideControllers=e.currentGame.status!==E.a.Start||!H()})))),this.moveEvent.pipe(function(e,t=d.a,n=z){return i=>i.lift(new R(e,t,n.leading,n.trailing))}(50),Object(C.a)(this.destroySubject)).subscribe(e=>{T.a.dispatch(function(e){return{type:y.a.Move,direction:e}}(e))})}))}initContainer(){this.container=new a.Container,this.container.sortableChildren=!0,this.pixi.app.stage.addChild(this.container)}loadLevel(e){return x.__awaiter(this,void 0,void 0,(function*(){this.setupAXY(),T.a.dispatch(function(e){return{type:y.a.Loading,name:e}}(e));const t=yield Object(P.a)(this.gameService.getLevel(e)).toPromise();T.a.dispatch(function(e,t){return{type:y.a.Loaded,name:e,level:t}}(e,t))}))}onResize(){this.devicePixelRatio=window.devicePixelRatio||1,T.a.dispatch({type:y.a.Resize,width:this.pixi.app.renderer.width,height:this.pixi.app.renderer.height})}setupAXY(){this.pixi.app.renderer&&T.a.dispatch({type:y.a.UpdateCenter,width:this.pixi.app.renderer.width,height:this.pixi.app.renderer.height,pixelRatio:this.devicePixelRatio})}move(e){this.moveEvent.next(e)}shot(){T.a.dispatch({type:y.a.Shot})}ngOnDestroy(){this.stop(),this.storeSubscribe&&this.storeSubscribe(),this.container&&this.container.destroy(),this.destroySubject.next(!0),this.destroySubject.complete(),this.fullscreen&&function(e){return x.__awaiter(this,void 0,void 0,(function*(){yield e.exitFullscreen()}))}(document).catch(e=>{console.warn(e)})}stop(){T.a.dispatch(Object(V.d)())}}var Z=n("vHjY"),I=n("lJxs"),Y=n("xk4V"),U=n.n(Y);const B=e=>e.map(W),W=e=>Object.keys(e).map(t=>{if(!Object.values(Z.a).find(e=>e===t))throw new Error(`Wrong enemy tank type: ${t} in map: ${name}`);return new Array(Number(e[t])).fill(0).map(()=>({id:`enemy-${U()()}`,type:t,direction:"down"}))}).reduce((e,t)=>e.concat(t),[]);class F{constructor(e){this.http=e}getLevels(){return this.http.get("assets/maps/maps.json").pipe(Object(I.a)(e=>e.filter(e=>e.includes("level")&&!e.includes("test"))))}getLevel(e){return this.http.get(`assets/maps/${e}.json`).pipe(Object(I.a)(e=>Object.assign({},e,{enemiesGroups:B(e.enemiesGroups)})))}}var N=n("U2x6"),$=n("efrx"),J=i.ob({encapsulation:0,styles:[['@import url(https://fonts.googleapis.com/css?family=VT323);.game[_ngcontent-%COMP%]{width:100%;height:100%}.game[_ngcontent-%COMP%]   app-pixi[_ngcontent-%COMP%]{width:100%;height:100%;display:block;overflow:hidden}.loading[_ngcontent-%COMP%]{z-index:2;background:#000;width:100vw;height:100vh;position:absolute}.loading[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:red;font-family:VT323,monospace;font-size:54px}.stats-bar[_ngcontent-%COMP%]{position:absolute;right:10px;top:0;z-index:1}.stats-bar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{height:32px;font-size:32px;font-family:VT323,monospace;font-weight:700}.stats-bar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]::before{content:"";height:32px;display:block;width:32px;line-height:32px;background-position:center center;float:left}.stats-bar[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:5px;float:left;line-height:32px}.stats-bar[_ngcontent-%COMP%]   .lives[_ngcontent-%COMP%]::before{background:url(/games/tanks/heart.8693ae5b957ee03faac9.png)}.stats-bar[_ngcontent-%COMP%]   .enemies[_ngcontent-%COMP%]::before{background:#afacb7;-webkit-mask-image:url(/games/tanks/tank-icon.817db94d9be6d4a0b42b.png);mask-image:url(/games/tanks/tank-icon.817db94d9be6d4a0b42b.png)}']],data:{}});function Q(e){return i.Hb(0,[i.Eb(402653184,1,{pixi:0}),(e()(),i.qb(1,0,null,null,0,"div",[["class","stats-bar"]],null,null,null,null,null)),(e()(),i.qb(2,0,null,null,6,"div",[["class","game"]],null,null,null,null,null)),(e()(),i.qb(3,0,null,null,1,"app-pixi",[],null,[["window","resize"]],(function(e,t,n){var s=!0;return"window:resize"===t&&(s=!1!==i.Bb(e,4).resize()&&s),s}),h,u)),i.pb(4,245760,[[1,4],["pixi",4]],0,r,[i.k,i.x,c.a],{devicePixelRatio:[0,"devicePixelRatio"]},null),(e()(),i.qb(5,0,null,null,1,"app-game-controllers",[],[[8,"hidden",0]],[[null,"move"],[null,"shot"],["document","keydown"],["document","keyup"]],(function(e,t,n){var s=!0,o=e.component;return"document:keydown"===t&&(s=!1!==i.Bb(e,6).handleKeyDownEvent(n)&&s),"document:keyup"===t&&(s=!1!==i.Bb(e,6).handleKeyUpEvent(n)&&s),"move"===t&&(s=!1!==o.move(n)&&s),"shot"===t&&(s=!1!==o.shot()&&s),s}),f,w)),i.pb(6,245760,null,0,v,[],null,{shot:"shot",move:"move"}),(e()(),i.qb(7,0,null,null,1,"button",[["class","menu-icon menu-button"],["routerLink",""]],null,[[null,"click"]],(function(e,t,n){var s=!0;return"click"===t&&(s=!1!==i.Bb(e,8).onClick()&&s),s}),null,null)),i.pb(8,16384,null,0,k.l,[k.k,k.a,[8,null],i.C,i.k],{routerLink:[0,"routerLink"]},null)],(function(e,t){e(t,4,0,t.component.devicePixelRatio),e(t,6,0),e(t,8,0,"")}),(function(e,t){e(t,5,0,t.component.hideControllers)}))}function ee(e){return i.Hb(0,[(e()(),i.qb(0,0,null,null,1,"app-game",[],null,[["window","resize"]],(function(e,t,n){var s=!0;return"window:resize"===t&&(s=!1!==i.Bb(e,1).onResize()&&s),s}),Q,J)),i.pb(1,4374528,null,0,X,[F,i.x,i.k,k.a,k.k,N.a,$.a],null,null)],null,null)}var te=i.mb("app-game",X,ee,{},{},[]),ne=n("SVse"),ie=n("IheW");const se={fullscreen:!0},oe={resume:!0,fullscreen:!0};class ae{}class le{}n.d(t,"GameModuleNgFactory",(function(){return re}));var re=i.nb(s,[],(function(e){return i.zb([i.Ab(512,i.j,i.Z,[[8,[o.a,te]],[3,i.j],i.v]),i.Ab(4608,ne.l,ne.k,[i.s,[2,ne.x]]),i.Ab(4608,F,F,[ie.c]),i.Ab(1073742336,ne.b,ne.b,[]),i.Ab(1073742336,k.n,k.n,[[2,k.s],[2,k.k]]),i.Ab(1073742336,ae,ae,[]),i.Ab(1073742336,le,le,[]),i.Ab(1073742336,s,s,[]),i.Ab(1024,k.i,(function(){return[[{path:"",component:X,data:se},{path:"resume",component:X,data:oe}]]}),[])])}))}}]);