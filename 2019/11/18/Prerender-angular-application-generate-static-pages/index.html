<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="msvalidate.01" content="292663BA216F36D83E3C5B19B43A0BA1"><meta name="description" content="Build an SEO friendly website without server-side rendering."><meta name="keywords" content="angular,prerender,universal"><meta property="og:type" content="article"><meta property="og:title" content="Prerender angular application - generate static pages"><meta property="og:url" content="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/index.html"><meta property="og:site_name" content="Studio La cosa nostra dev blog"><meta property="og:description" content="Build an SEO friendly website without server-side rendering."><meta property="og:locale" content="en"><meta property="og:image" content="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/title-image.png"><meta property="og:updated_time" content="2020-04-19T18:33:40.328Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Prerender angular application - generate static pages"><meta name="twitter:description" content="Build an SEO friendly website without server-side rendering."><meta name="twitter:image" content="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/title-image.png"><meta name="twitter:creator" content="@la_cosa_nostrai"><meta name="twitter:site" content="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>Prerender angular application - generate static pages</title><link rel="stylesheet" href="/css/style.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/style.css"></noscript><link rel="stylesheet" href="/css/rtl.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/rtl.css"></noscript><link rel="amphtml" href="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/amp/index.html"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-7811559275890870",enable_page_level_ads:!0})</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-133020393-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-133020393-1")</script><meta name="google-site-verification" content="M3LE90r-9Zi3bh6WJc9u3Dv4Y4iN5uAbCLOoKKB5STg"><meta name="yandex-verification" content="d79c4ffd80f4db16"><meta name="monetization" content="$coil.xrptipbot.com/-LgHcPIpRjOKFZ99hUWsgg"><meta name="p:domain_verify" content="f40f638a911806fcc1b1d6ce99ecd6ff"><link rel="canonical" href="https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/"><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="/css/prism.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism.css"></noscript><link rel="stylesheet" href="/css/prism-line-numbers.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism-line-numbers.css"></noscript><link rel="stylesheet" href="/css/prism.css" media="none" onload="if(media!='all')media='all'"><noscript><link rel="stylesheet" href="/css/prism.css"></noscript>
<link rel="stylesheet" href="/css/prism-line-numbers.css" media="none" onload="if(media!='all')media='all'"><noscript><link rel="stylesheet" href="/css/prism-line-numbers.css"></noscript></head><body class="max-width mx-auto px3 ltr"><cookie-consent>This site uses cookies to analyse traffic, remember your preferences, and optimise your experience. <a href="/privacy-policy.html">Learn more, read the privacy policy page.</a></cookie-consent><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" style="display:none"><i class="fas fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/projects">Projects</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/2019/12/17/Create-newsletter-with-firebase-and-angular/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$(&quot;#i-prev&quot;).toggle()" onmouseout="$(&quot;#i-prev&quot;).toggle()"></i></a></li><li><a class="icon" href="/2019/10/09/Color-cells-using-keyboard-shortcuts-in-Google-Sheets/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$(&quot;#i-next&quot;).toggle()" onmouseout="$(&quot;#i-next&quot;).toggle()"></i></a></li><li><a class="icon" href="#" onclick="$(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$(&quot;#i-top&quot;).toggle()" onmouseout="$(&quot;#i-top&quot;).toggle()"></i></a></li><li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$(&quot;#i-share&quot;).toggle()" onmouseout="$(&quot;#i-share&quot;).toggle()" onclick="return $(&quot;#share&quot;).toggle(),!1"></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><link rel="stylesheet" href="/css/prism.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism.css"></noscript><link rel="stylesheet" href="/css/prism-line-numbers.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism-line-numbers.css"></noscript><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;text=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;is_video=false&amp;description=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Prerender angular application - generate static pages&amp;body=Check out this article: https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/"><i class="fas fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;name=Prerender angular application - generate static pages&amp;description=<html><head></head><body><p><strong>Build an SEO friendly website without server-side rendering.</strong><br></p></body></html>" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-tumblr" aria-hidden="true"></i></a></li></ul></div><div id="toc"></div></span></div><div class="content index py4"><article class="post"><header><link rel="stylesheet" href="/css/prism.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism.css"></noscript><link rel="stylesheet" href="/css/prism-line-numbers.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism-line-numbers.css"></noscript><h1 class="posttitle">Prerender angular application - generate static pages</h1><div class="meta"><div class="postdate"><time datetime="2019-11-18T00:00:00.000Z">2019-11-18</time></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link" href="/tags/angular/">angular</a>, <a class="tag-link" href="/tags/prerender/">prerender</a>, <a class="tag-link" href="/tags/universal/">universal</a></div></div></header><img class="image" src="/2019/11/18/Prerender-angular-application-generate-static-pages/title-image.png" alt="Prerender angular application - generate static pages" loading="lazy"><div class="content"><p><strong>Build an SEO friendly website without server-side rendering.</strong><br><a id="more"></a></p><p>From the very beginning of Angular 2, there was a capability to generate HTML content of the application on the server-side. Without this, bots search engines simply are not able to see what is on the site without the interpretation of javascript very few bots will improve. But what if you don’t have a server with node.js and you want to be visible? Prerender subpages may help in this case. In previous versions of Angular Universal, there is an example of how to do this <a href="https://github.com/angular/universal-starter/blob/master/prerender.ts" rel="external nofollow noopener noreferrer" target="_blank">link to prerender.ts in universal-starter archive</a>. Some time has passed and angular universal has officially become part of the Angular ecosystem, but unfortunately, there is no example of how to make prerender code anywhere.<br>Today I present an example of how I solved it in my project trying to minimize the interference in the generated nguniversal code.</p><p>First of all, you need to add angular universal to your project with this command from <a href="https://angular.io/guide/universal" rel="external nofollow noopener noreferrer" target="_blank">server-side rendering guide</a></p><pre class="line-numbers language-bash"><code class="language-bash">ng add @nguniversal/express-engine --clientProject project-example
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>It will generate all the scripts to run server-side rendering in our application. You need it to generate static pages.</p><p>The next step is to transfer the code fragments responsible for creating the express server from <code>server.ts</code> to a new <code>express-app.ts</code> file. Below is the code that you should paste into the new file.</p><p><code>express-app.ts</code></p><pre class="line-numbers language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token string">'zone.js/dist/zone-node'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> express <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> join <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>

<span class="token comment">// Express server</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">DIST_FOLDER</span> <span class="token operator">=</span> <span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'dist/browser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// * NOTE :: leave this as require() since this file is built Dynamically from webpack</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>AppServerModuleNgFactory<span class="token punctuation">,</span> <span class="token constant">LAZY_MODULE_MAP</span><span class="token punctuation">,</span> ngExpressEngine<span class="token punctuation">,</span> provideModuleMap<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'./dist/server/main'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Our Universal express-engine (found @ https://github.com/angular/universal/tree/master/modules/express-engine)</span>
app<span class="token punctuation">.</span><span class="token function">engine</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">,</span> <span class="token function">ngExpressEngine</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  bootstrap<span class="token operator">:</span> AppServerModuleNgFactory<span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">provideModuleMap</span><span class="token punctuation">(</span><span class="token constant">LAZY_MODULE_MAP</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token constant">DIST_FOLDER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Example Express Rest API endpoints</span>
<span class="token comment">// app.get('/api/**', (req, res) =&gt; { });</span>
<span class="token comment">// Serve static files from /browser</span>
app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'*.*'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token keyword">static</span><span class="token punctuation">(</span><span class="token constant">DIST_FOLDER</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  maxAge<span class="token operator">:</span> <span class="token string">'1y'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// All regular routes use the Universal engine</span>
app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> req <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Then remove the express server code from the <code>server.ts</code> and instead import it from the <code>express-app.ts</code> leaving only the code listening to the port.</p><p><code>server.ts</code></p><pre class="line-numbers language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> app <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./express-app'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">4000</span><span class="token punctuation">;</span>

<span class="token comment">// Start up the Node server</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Node Express server listening on http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Now add the main code that performs prerender of our subpages. (you also need to install additional library to create subfolders <code>npm install mkdirp @types/mkdirp</code>)</p><p><code>prerender.ts</code></p><pre class="line-numbers language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> request <span class="token keyword">from</span> <span class="token string">'request-promise'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> mkdirp <span class="token keyword">from</span> <span class="token string">'mkdirp'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> promisify <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'util'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> writeFileSync <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Express <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> app <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./express-app'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ROUTES</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'/'</span><span class="token punctuation">,</span>
  <span class="token string">'/auth'</span><span class="token punctuation">,</span>
  <span class="token string">'/privacy-policy'</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mkdirpAsync <span class="token operator">=</span> <span class="token function">promisify</span><span class="token punctuation">(</span>mkdirp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">prerender</span><span class="token punctuation">(</span><span class="token parameter">expressApp<span class="token operator">:</span> Express<span class="token punctuation">,</span> routes<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token constant">PORT</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PRERENDER_PORT</span> <span class="token operator">||</span> <span class="token number">4000</span><span class="token punctuation">;</span>
  <span class="token comment">// Start up the Node server</span>
  <span class="token keyword">const</span> server <span class="token operator">=</span> expressApp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> route <span class="token keyword">of</span> routes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> request<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>route<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> <span class="token function">mkdirpAsync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dist/browser</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>route<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">dist/browser</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>route<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Prerender complete.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      server<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      server<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">prerender</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token constant">ROUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Now add the main code that performs prerender of our subpages. (you also need to install additional library to create subfolders <code>npm install mkdirp @types/mkdirp</code>)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment">// Work around for https://github.com/angular/angular-cli/issues/7200</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// This is our Express server for Dynamic universal</span>
    server<span class="token operator">:</span> <span class="token string">'./server.ts'</span><span class="token punctuation">,</span>
    prerender<span class="token operator">:</span> <span class="token string">'./prerender.ts'</span> <span class="token comment">// &lt;--------------- HERE!!!</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  externals<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'./dist/server/main'</span><span class="token operator">:</span> <span class="token string">'require("./server/main")'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  target<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span> extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimize<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Puts the output at the root of the dist folder</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    noParse<span class="token operator">:</span> <span class="token regex">/polyfills-.*\.js/</span><span class="token punctuation">,</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> test<span class="token operator">:</span> <span class="token regex">/\.ts$/</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token string">'ts-loader'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// Mark files inside `@angular/core` as using SystemJS style dynamic imports.</span>
        <span class="token comment">// Removing this will cause deprecation warnings to appear.</span>
        test<span class="token operator">:</span> <span class="token regex">/(\\|\/)@angular(\\|\/)core(\\|\/).+\.js$/</span><span class="token punctuation">,</span>
        parser<span class="token operator">:</span> <span class="token punctuation">{</span> system<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ContextReplacementPlugin</span><span class="token punctuation">(</span>
      <span class="token comment">// fixes WARNING Critical dependency: the request of a dependency is an expression</span>
      <span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token function">angular</span><span class="token punctuation">(</span>\\<span class="token operator">|</span>\<span class="token regex">/)core(.+)?/</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// location of your src</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// a map of your routes</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ContextReplacementPlugin</span><span class="token punctuation">(</span>
      <span class="token comment">// fixes WARNING Critical dependency: the request of a dependency is an expression</span>
      <span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">+</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token function">express</span><span class="token punctuation">(</span>\\<span class="token operator">|</span>\<span class="token regex">/)(.+)?/</span><span class="token punctuation">,</span>
      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Add a new script to <code>package.json</code> for ease of use.</p><pre class="line-numbers language-json"><code class="language-json">
"scripts": {
  ...
  "prerender": "node dist/prerender",
  ...
}

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>And that’s all, now you just need to build an application in SSR mode and run the command prerender.</p><pre class="line-numbers language-bash"><code class="language-bash">npm run build:ssr &amp;&amp; npm run prerender
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>In the <code>dist/browser</code> directory, you will find subfolders with <code>index.html</code> files containing SEO-friendly generated HTML content of the application.</p><p>If you are using @angular/service-worker then you will need to reconfigure right after the <code>prerender</code> because the checksum value in the index.html file has changed after the html modification.</p><pre class="line-numbers language-bash"><code class="language-bash">ngsw-config dist/browser ngsw-config.json
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>An example of a working page on this solution is my second <a href="https://rayros.github.io/" rel="external nofollow noopener noreferrer" target="_blank">programming blog</a>.</p><p>Prerender in Angular 9 has an error on the production build.</p><p><a href="https://github.com/angular/angular-cli/issues/17021" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/angular/angular-cli/issues/17021</a></p><p>When they solve the problem, I will probably update the post to keep it up to date with the latest Angular.</p></div><div>Word count: 897</div></article><div class="newsletter-form"><p><b>Want to know more and be immediately informed about new posts?</b></p><p>Let's stay in touch and leave your email:</p><newsletter-subscribe-form newsletter="f4bac83a-d13d-4d9a-91d1-84e66abb6176"></newsletter-subscribe-form></div><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the comments.</noscript></div></div>Related posts:<ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-img"><img src="/2019/02/18/Angular-Custom-class-decorator-Force-OnInit-OnDestroy-implementation/title-image.png" loading="lazy"></div><div class="popular-posts-title"><h3><a href="/2019/02/18/Angular-Custom-class-decorator-Force-OnInit-OnDestroy-implementation/" title="Angular: Custom class decorator. Force OnInit, OnDestroy implementation." rel="bookmark">Angular: Custom class decorator. Force OnInit, OnDestroy implementation.</a></h3></div><div class="popular-posts-excerpt"><p></p><p>How to create a good decorator in angular.<br></p><p></p></div></li><li class="popular-posts-item"><div class="popular-posts-img"><img src="/2019/09/14/Angular-Zone-WebSocket-Change-detection-Nightmare/title-image.png" loading="lazy"></div><div class="popular-posts-title"><h3><a href="/2019/09/14/Angular-Zone-WebSocket-Change-detection-Nightmare/" title="Angular, Zone, WebSocket  === Change detection Nightmare" rel="bookmark">Angular, Zone, WebSocket === Change detection Nightmare</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-img"><img src="/2019/04/02/Angular-async-pipe-does-not-work-in-the-electron/title-image.png" loading="lazy"></div><div class="popular-posts-title"><h3><a href="/2019/04/02/Angular-async-pipe-does-not-work-in-the-electron/" title="Angular async pipe does not work in the electron" rel="bookmark">Angular async pipe does not work in the electron</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-img"><img src="/2019/07/19/Build-a-reusable-Angular-library-and-web-component/title-image.png" loading="lazy"></div><div class="popular-posts-title"><h3><a href="/2019/07/19/Build-a-reusable-Angular-library-and-web-component/" title="Build a reusable Angular library and web component" rel="bookmark">Build a reusable Angular library and web component</a></h3></div><div class="popular-posts-excerpt"><p></p><p>Find out how to easily create libraries in Angular and transform them into web-components.<br></p><p></p></div></li><li class="popular-posts-item"><div class="popular-posts-img"><img src="/2019/05/16/How-to-debug-Angular-tests-in-VSCode/title-image.png" loading="lazy"></div><div class="popular-posts-title"><h3><a href="/2019/05/16/How-to-debug-Angular-tests-in-VSCode/" title="How to debug Angular tests in VSCode" rel="bookmark">How to debug Angular tests in VSCode</a></h3></div></li></ul><script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "thumbnailUrl": "https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/title-image.png",
  "url": "https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/",
  "name": "Prerender angular application - generate static pages",
  "headline": "Prerender angular application - generate static pages",
  "dateCreated": "2020-04-19T18:33:40.328Z",
  "datePublished": "2020-04-19T18:33:40.328Z",
  "dateModified": "2020-04-19T18:33:40.328Z",
  "image": "https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/title-image.png",
  "keywords": [
    "angular","prerender","universal"
  ],
  "mainEntityOfPage": "https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/",
  "author": {
    "@type": "Organization",
    "name": "Studio La Cosa Nostra"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Studio La Cosa Nostra",
    "url": "https://studiolacosanostra.github.io",
    "logo": {
      "@type": "ImageObject",
      "width": "615",
      "height": "615",
      "url": "https://studiolacosanostra.github.io/images/logo.png"
    }
  }
}</script><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/projects">Projects</a></li></ul></div><div id="toc-footer" style="display:none"></div><div id="share-footer" style="display:none"><link rel="stylesheet" href="/css/prism.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism.css"></noscript><link rel="stylesheet" href="/css/prism-line-numbers.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/css/prism-line-numbers.css"></noscript><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;text=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;is_video=false&amp;description=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Prerender angular application - generate static pages&amp;body=Check out this article: https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;title=Prerender angular application - generate static pages" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://studiolacosanostra.github.io/2019/11/18/Prerender-angular-application-generate-static-pages/&amp;name=Prerender angular application - generate static pages&amp;description=<html><head></head><body><p><strong>Build an SEO friendly website without server-side rendering.</strong><br></p></body></html>" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><a id="menu" class="icon" href="#" onclick="return $(&quot;#nav-footer&quot;).toggle(),!1"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" href="#" onclick="return $(&quot;#toc-footer&quot;).toggle(),!1"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="share" class="icon" href="#" onclick="return $(&quot;#share-footer&quot;).toggle(),!1"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a> <a id="top" style="display:none" class="icon" href="#" onclick="$(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright © 2020 Studio La Cosa Nostra | Words: 14.8k</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/projects">Projects</a></li><li><a href="/privacy-policy.html">Privacy Policy</a></li></ul></nav></div></footer></div><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"></noscript><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css" media="none" onload="&quot;all&quot;!=media&amp;&amp;(media=&quot;all&quot;)"><noscript><link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"></noscript><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script><script>$(document).ready(function () {
    document.querySelectorAll('article li img, article p img, article td img').forEach((element) => {
      const src = element.getAttribute('src');
      element.addEventListener('click', (e) => {
        e.preventDefault();
        if (window.trackOutboundLink) {
          trackOutboundLink(src);
        }
        window.open(src, "_blank");
      });
    });
  });</script><script src="/js/main.js"></script><script type="text/javascript">var disqus_shortname="studio-la-cosa-nostra";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/studioLaCosaNostra/cookie-consent@latest/dist/cookie-consent/cookie-consent.js"></script><script async="" type="text/javascript" src="https://cdn.jsdelivr.net/npm/@email-newsletter/newsletter-subscribe-form@0.0.9/custom-element/main-es5.js"></script><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/@angular/material@8.1.0/prebuilt-themes/indigo-pink.css" rel="stylesheet"><script type="application/ld+json">{
      "@context": "http://schema.org",
      "@type": "WebSite",
      "url": "https://studiolacosanostra.github.io",
      "name": "Studio La cosa nostra dev blog"
    }</script><script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "Studio La cosa nostra dev blog",
        "email": "studiolacosanostra@gmail.com",
        "url": "https://studiolacosanostra.github.io",
        "sameAs": [
          "https://www.facebook.com/studiolacosanostra/",
          "https://twitter.com/la_cosa_nostrai",
          "https://github.com/studioLaCosaNostra",
          "https://play.google.com/store/apps/developer?id=La+cosa+nostra",
          "https://www.youtube.com/channel/UCTCoOqyugQFUTX1it84LkRA",
          "https://www.linkedin.com/company/studio-la-cosa-nostra/"
        ]
      }</script></body></html>